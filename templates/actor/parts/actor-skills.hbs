<div>
    <input type="checkbox" id="system.settings.hideZeroAPSkills" name="system.settings.hideZeroAPSkills" value="true" {{#if (compare system.settings.hideZeroAPSkills "eq" "true" )}} checked {{/if}}>
    <label for="system.settings.hideZeroAPSkills"> {{localize "MEGS.HideZeroRankSkills"}}</label>
</div>

<ol class='items-list'>
    <li class='item flexrow items-header'>
        <div class='item-toggle'></div>
        <div class='item-name'>{{localize 'MEGS.Name'}}</div>
        <div class='item-aps'>{{localize 'MEGS.APs'}}</div>
        <div class='item-controls'></div>
    </li>
    {{#each filteredSkills as |item id|}}
        <li class='item flexrow item-row skill-row {{#if item.system.aps}}bold{{/if}}' data-item-id='{{item._id}}' data-expanded='false'>
            <div class='item-toggle'>
                <i class='fas fa-chevron-right toggle-icon'></i>
            </div>
            <div class='item-name'>
                <a class='item-control item-edit' title='{{localize "DOCUMENT.Update" type=item.name}}'>
                    {{getSkillDisplayName item}}
                </a>
            </div>
            <div class='item-aps'>
                {{#if ../flags.megs.edit-mode}}
                    {{#if item.isFromLinkedGadget}}
                        {{item.system.aps}}
                    {{else}}
                        <div class="quantity skill-input">
                            <button class="ap-minus" aria-label="Decrease" data-item-id="{{item._id}}">&minus;</button>
                            <input id="skill-aps-{{item._id}}" name="system.aps" type="number" class="input-box" value="{{item.system.aps}}" min="0" data-dtype="Number" readonly />
                            <button class="ap-plus" aria-label="Increase" data-item-id="{{item._id}}">&plus;</button>
                        </div>
                    {{/if}}
                {{else}}
                    {{item.system.aps}}
                {{/if}}
            </div>
            <div class='item-controls'>
                {{#unless item.system.aps}}
                    {{#if (compare item.system.useUnskilled '===' 'true')}}
                        <a class='item-control d10 rollable' title='{{localize "MEGS.Roll"}} {{item.name}} {{#if (compare item.system.aps '===' 0)}} (Unskilled){{/if}}' data-label="{{item.name}}" data-roll="1d10 + 1d10" {{#if (compare item.system.aps '!==' 0)}}data-value="{{item.system.aps}}" {{/if}} {{#unless (compare item.system.aps '!==' 0)}} data-value="{{item.linkedAPs}}" {{/unless}} data-type="skill" data-link="{{item.system.link}}" {{#if (compare item.system.aps '===' 0)}}data-unskilled="true" {{/if}}>
                            <img src="/systems/megs/assets/images/icons/d10grey-2.png" class="svg-icon" alt="Roll Unskilled" />
                        </a>
                    {{/if}}
                    {{#unless (compare item.system.useUnskilled '===' 'true')}}
                        <img src="/systems/megs/assets/images/icons/transparent.png" class="svg-icon" />
                    {{/unless}}
                {{/unless}}
                {{#if item.system.aps}}
                    <a class='item-control d10 rollable' title='{{localize "MEGS.Roll"}} {{item.name}} {{#if (compare item.system.aps '===' 0)}} ({{localize "MEGS.Unskilled"}}){{/if}}' data-label="{{item.name}}" data-roll="1d10 + 1d10" {{#if (compare item.system.aps '!==' 0)}}data-value="{{item.system.aps}}" {{/if}} {{#unless (compare item.system.aps '!==' 0)}} data-value="{{item.linkedAPs}}" {{/unless}} data-type="skill" data-link="{{item.system.link}}" {{#if (compare item.system.aps '===' 0)}}data-unskilled="true" {{/if}}>
                        <img src="/systems/megs/assets/images/icons/d10blue.png" class="svg-icon" alt="Roll" />
                    </a>
                {{/if}}
                {{#unless item.isFromLinkedGadget}}
                    <a class='item-control item-edit' title='{{localize "MEGS.Edit" type=item.name}}'>
                        <img src="/systems/megs/assets/images/icons/edit.png" class="svg-icon" alt="{{localize " MEGS.Edit" type=item.name}}" />
                    </a>
                    {{#if ../flags.megs.edit-mode}}
                        <a class='item-control item-delete' title='{{localize "DOCUMENT.Delete" type=' Item'}}'>
                            <i class='fas fa-trash'></i>
                        </a>
                    {{/if}}
                {{/unless}}
            </div>
        </li>
        {{!-- Display Subskills under the Skill --}}
        {{#each (getSkillSubskills item._id ../items) as |subskill|}}
            <li class='item flexrow item-row modifier-row subskill-row' data-item-id='{{subskill._id}}' data-parent-id='{{item._id}}' style='display: none;'>
                <div class='item-toggle'></div>
                <div class='item-name modifier-name'>
                    <input type="checkbox" class="subskill-checkbox" {{checked subskill.system.isTrained}} data-item-id="{{subskill._id}}" {{#if (compare item.system.aps "===" 0)}}disabled{{/if}} {{#unless ../../flags.megs.edit-mode}}disabled{{/unless}} />
                    <span style="display: inline-block; width: 10px;"></span>{{subskill.name}}
                </div>
                <div class='item-aps'></div>
                <div class='item-controls'></div>
            </li>
        {{/each}}
    {{/each}}
</ol>